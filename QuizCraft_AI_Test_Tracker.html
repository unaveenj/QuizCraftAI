<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QuizCraft AI - Test Tracker</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        .header {
            background: #3b82f6;
            color: white;
            padding: 20px;
            text-align: center;
        }
        .header h1 {
            margin: 0;
            font-size: 2rem;
        }
        .controls {
            padding: 20px;
            border-bottom: 1px solid #e5e7eb;
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            align-items: center;
        }
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.2s;
        }
        .btn-primary {
            background: #3b82f6;
            color: white;
        }
        .btn-primary:hover {
            background: #2563eb;
        }
        .btn-success {
            background: #10b981;
            color: white;
        }
        .btn-success:hover {
            background: #059669;
        }
        .stats {
            display: flex;
            gap: 20px;
            margin-left: auto;
        }
        .stat {
            text-align: center;
            padding: 10px;
            background: #f8fafc;
            border-radius: 5px;
            min-width: 80px;
        }
        .stat-number {
            font-size: 1.5rem;
            font-weight: bold;
            color: #1e293b;
        }
        .stat-label {
            font-size: 0.8rem;
            color: #64748b;
        }
        .content {
            display: flex;
            height: 70vh;
        }
        .table-container {
            flex: 2;
            overflow: auto;
            border-right: 1px solid #e5e7eb;
        }
        .chart-container {
            flex: 1;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.9rem;
        }
        th, td {
            padding: 12px 8px;
            text-align: left;
            border-bottom: 1px solid #e5e7eb;
        }
        th {
            background: #f8fafc;
            font-weight: 600;
            position: sticky;
            top: 0;
            z-index: 10;
        }
        tr.pass {
            background-color: #dcfce7 !important;
        }
        tr.fail {
            background-color: #fee2e2 !important;
        }
        tr:hover {
            background-color: #f1f5f9;
        }
        tr.pass:hover {
            background-color: #bbf7d0 !important;
        }
        tr.fail:hover {
            background-color: #fecaca !important;
        }
        .status-select {
            padding: 5px 10px;
            border: 1px solid #d1d5db;
            border-radius: 4px;
            background: white;
            width: 100%;
            max-width: 100px;
        }
        .test-id {
            font-weight: bold;
            color: #3b82f6;
        }
        .severity {
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 500;
        }
        .severity.critical {
            background: #fee2e2;
            color: #991b1b;
        }
        .severity.high {
            background: #fef3c7;
            color: #92400e;
        }
        .severity.medium {
            background: #dbeafe;
            color: #1e40af;
        }
        .severity.low {
            background: #f0fdf4;
            color: #166534;
        }
        #chart {
            max-width: 300px;
            max-height: 300px;
        }
        .chart-stats {
            margin-top: 20px;
            text-align: center;
        }
        .progress-bar {
            width: 100%;
            height: 20px;
            background: #e5e7eb;
            border-radius: 10px;
            overflow: hidden;
            margin: 10px 0;
        }
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #10b981, #059669);
            transition: width 0.3s ease;
            border-radius: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ðŸ§  QuizCraft AI - Functional Test Tracker</h1>
            <p>Interactive test case management with real-time reporting</p>
        </div>
        
        <div class="controls">
            <button class="btn btn-primary" onclick="downloadExcel()">
                ðŸ“Š Download Excel File
            </button>
            <button class="btn btn-success" onclick="resetAllTests()">
                ðŸ”„ Reset All Tests
            </button>
            <button class="btn btn-primary" onclick="exportResults()">
                ðŸ“‹ Export Results
            </button>
            
            <div class="stats">
                <div class="stat">
                    <div class="stat-number" id="totalTests">88</div>
                    <div class="stat-label">Total Tests</div>
                </div>
                <div class="stat">
                    <div class="stat-number" id="passedTests">0</div>
                    <div class="stat-label">Passed</div>
                </div>
                <div class="stat">
                    <div class="stat-number" id="failedTests">0</div>
                    <div class="stat-label">Failed</div>
                </div>
                <div class="stat">
                    <div class="stat-number" id="passRate">0%</div>
                    <div class="stat-label">Pass Rate</div>
                </div>
            </div>
        </div>
        
        <div class="content">
            <div class="table-container">
                <table id="testTable">
                    <thead>
                        <tr>
                            <th>Test ID</th>
                            <th>Category</th>
                            <th>Test Case Description</th>
                            <th>Severity</th>
                            <th>Expected Result</th>
                            <th>Status</th>
                            <th>Notes</th>
                        </tr>
                    </thead>
                    <tbody id="testTableBody">
                        <!-- Test cases will be populated here -->
                    </tbody>
                </table>
            </div>
            
            <div class="chart-container">
                <h3>Test Results Overview</h3>
                <canvas id="chart"></canvas>
                <div class="chart-stats">
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill" style="width: 0%"></div>
                    </div>
                    <p><strong id="progressText">0% Complete</strong></p>
                    <p>Ready for release when 95%+ pass rate achieved</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Test cases data
        const testCases = [
            // Initial Setup & Landing Page
            { id: "T001-01", category: "Landing Page", description: "Open index.html in browser without errors", severity: "critical", expected: "Page loads successfully" },
            { id: "T001-02", category: "Landing Page", description: "Verify hero section displays with stats (47%, 3x, 92%)", severity: "high", expected: "All statistics visible and correct" },
            { id: "T001-03", category: "Landing Page", description: "Test theme toggle functionality", severity: "medium", expected: "Theme switches smoothly between light/dark" },
            { id: "T001-04", category: "Landing Page", description: "Verify 'Get Started Free' button links to app.html", severity: "high", expected: "Button navigates to quiz app" },
            { id: "T001-05", category: "Landing Page", description: "Check responsive design on mobile/tablet", severity: "medium", expected: "Layout adapts to screen sizes" },
            
            // Application Launch & Navigation
            { id: "T002-01", category: "Navigation", description: "Click 'Get Started Free' button", severity: "critical", expected: "App.html loads with quiz creation active" },
            { id: "T002-02", category: "Navigation", description: "Test sidebar navigation to Overview", severity: "high", expected: "Overview page loads correctly" },
            { id: "T002-03", category: "Navigation", description: "Test sidebar navigation to Create Quiz", severity: "high", expected: "Create Quiz page loads correctly" },
            { id: "T002-04", category: "Navigation", description: "Test sidebar navigation to Quiz History", severity: "medium", expected: "Quiz History page loads correctly" },
            { id: "T002-05", category: "Navigation", description: "Test sidebar navigation to Settings", severity: "high", expected: "Settings page loads correctly" },
            { id: "T002-06", category: "Navigation", description: "Verify 'Back to Home' button functionality", severity: "medium", expected: "Returns to landing page" },
            { id: "T002-07", category: "Navigation", description: "Test theme toggle persistence across pages", severity: "low", expected: "Theme preference maintained" },
            
            // API Configuration & Testing
            { id: "T003-01", category: "API Config", description: "Navigate to Settings â†’ API Configuration", severity: "high", expected: "API config section visible" },
            { id: "T003-02", category: "API Config", description: "Enter invalid API key format (not sk-)", severity: "high", expected: "Warning message appears" },
            { id: "T003-03", category: "API Config", description: "Enter valid API key format", severity: "high", expected: "Validation passes" },
            { id: "T003-04", category: "API Config", description: "Test API key visibility toggle", severity: "medium", expected: "Password field toggles visibility" },
            { id: "T003-05", category: "API Config", description: "Test connection with invalid key", severity: "high", expected: "Error message displayed" },
            { id: "T003-06", category: "API Config", description: "Test connection with valid key", severity: "critical", expected: "Success message displayed" },
            { id: "T003-07", category: "API Config", description: "Click 'Diagnose Issues' button", severity: "medium", expected: "Diagnostic report appears" },
            
            // API Key Help System
            { id: "T004-01", category: "Help System", description: "Hover over â„¹ï¸ icon next to API Key", severity: "medium", expected: "Tooltip with instructions appears" },
            { id: "T004-02", category: "Help System", description: "Click platform.openai.com link in tooltip", severity: "low", expected: "Opens in new tab" },
            { id: "T004-03", category: "Help System", description: "Click API keys page link in tooltip", severity: "low", expected: "Opens correct page in new tab" },
            { id: "T004-04", category: "Help System", description: "Test tooltip on mobile (tap behavior)", severity: "low", expected: "Mobile-friendly interaction" },
            
            // Model Selection & Settings
            { id: "T005-01", category: "Model Selection", description: "Verify AI model dropdown shows GPT-4o Mini", severity: "high", expected: "GPT-4o Mini option available" },
            { id: "T005-02", category: "Model Selection", description: "Verify AI model dropdown shows GPT-4o", severity: "high", expected: "GPT-4o option available" },
            { id: "T005-03", category: "Model Selection", description: "Verify default model is GPT-4o Mini", severity: "medium", expected: "GPT-4o Mini pre-selected" },
            { id: "T005-04", category: "Model Selection", description: "Test model selection in quiz creation", severity: "high", expected: "Model selection works" },
            { id: "T005-05", category: "Model Selection", description: "Test model selection in settings", severity: "high", expected: "Model selection works" },
            { id: "T005-06", category: "Model Selection", description: "Check cost estimator shows correct pricing", severity: "medium", expected: "Accurate pricing displayed" },
            
            // Quiz Creation Interface
            { id: "T006-01", category: "Quiz Creation", description: "Navigate to Create Quiz page", severity: "critical", expected: "Create Quiz page loads" },
            { id: "T006-02", category: "Quiz Creation", description: "Test quiz description textarea input", severity: "high", expected: "Text input works correctly" },
            { id: "T006-03", category: "Quiz Creation", description: "Verify placeholder text is helpful", severity: "low", expected: "Clear examples provided" },
            { id: "T006-04", category: "Quiz Creation", description: "Check character/word counter updates", severity: "low", expected: "Counter updates in real-time" },
            { id: "T006-05", category: "Quiz Creation", description: "Click 'Upload Materials' tab", severity: "medium", expected: "Upload interface appears" },
            { id: "T006-06", category: "Quiz Creation", description: "Verify upload zone functionality", severity: "medium", expected: "Upload zone responds to interaction" },
            { id: "T006-07", category: "Quiz Creation", description: "Test number of questions slider (5-50)", severity: "high", expected: "Slider works with correct range" },
            { id: "T006-08", category: "Quiz Creation", description: "Test difficulty selection buttons", severity: "high", expected: "Difficulty buttons toggle correctly" },
            { id: "T006-09", category: "Quiz Creation", description: "Test question types checkboxes", severity: "high", expected: "Checkboxes work correctly" },
            { id: "T006-10", category: "Quiz Creation", description: "Test focus areas dropdown", severity: "medium", expected: "Dropdown options work" },
            
            // Token Usage Meter
            { id: "T007-01", category: "Usage Tracking", description: "Locate usage meter in top-right header", severity: "medium", expected: "Usage meter visible" },
            { id: "T007-02", category: "Usage Tracking", description: "Verify initial display shows '0 tokens (~$0.000)'", severity: "medium", expected: "Correct initial values" },
            { id: "T007-03", category: "Usage Tracking", description: "Test reset button (â†» icon) click", severity: "medium", expected: "Counter resets to zero" },
            { id: "T007-04", category: "Usage Tracking", description: "Check reset notification appears", severity: "low", expected: "Success notification shown" },
            { id: "T007-05", category: "Usage Tracking", description: "Verify green color for low usage", severity: "low", expected: "Green color displayed" },
            { id: "T007-06", category: "Usage Tracking", description: "Test meter responsiveness on mobile", severity: "low", expected: "Meter adapts to screen size" },
            
            // Quiz Generation Process
            { id: "T008-01", category: "Quiz Generation", description: "Enter valid API key in settings", severity: "critical", expected: "API key accepted" },
            { id: "T008-02", category: "Quiz Generation", description: "Enter quiz description", severity: "critical", expected: "Description entered successfully" },
            { id: "T008-03", category: "Quiz Generation", description: "Configure quiz settings", severity: "high", expected: "Settings configured" },
            { id: "T008-04", category: "Quiz Generation", description: "Click 'Generate Quiz with AI'", severity: "critical", expected: "Generation process starts" },
            { id: "T008-05", category: "Quiz Generation", description: "Verify loading state with spinner", severity: "medium", expected: "Loading indicator shown" },
            { id: "T008-06", category: "Quiz Generation", description: "Check token usage meter updates", severity: "high", expected: "Usage meter increments" },
            { id: "T008-07", category: "Quiz Generation", description: "Verify quiz interface loads with questions", severity: "critical", expected: "Quiz questions displayed" },
            { id: "T008-08", category: "Quiz Generation", description: "Test quiz navigation buttons", severity: "high", expected: "Navigation works correctly" },
            { id: "T008-09", category: "Quiz Generation", description: "Check progress bar updates", severity: "medium", expected: "Progress shown accurately" },
            
            // Quiz Taking Experience
            { id: "T009-01", category: "Quiz Taking", description: "Answer multiple choice questions", severity: "critical", expected: "Answer selection works" },
            { id: "T009-02", category: "Quiz Taking", description: "Test true/false questions", severity: "high", expected: "True/false options work" },
            { id: "T009-03", category: "Quiz Taking", description: "Test fill-in-blank questions", severity: "high", expected: "Text input works" },
            { id: "T009-04", category: "Quiz Taking", description: "Test previous/next navigation", severity: "high", expected: "Navigation preserves answers" },
            { id: "T009-05", category: "Quiz Taking", description: "Submit quiz and view results", severity: "critical", expected: "Results page loads" },
            { id: "T009-06", category: "Quiz Taking", description: "Check score calculation accuracy", severity: "high", expected: "Score calculated correctly" },
            { id: "T009-07", category: "Quiz Taking", description: "Test 'Create New Quiz' button", severity: "medium", expected: "Returns to quiz creation" },
            { id: "T009-08", category: "Quiz Taking", description: "Test 'Back to Dashboard' button", severity: "medium", expected: "Returns to dashboard" },
            
            // Error Handling
            { id: "T010-01", category: "Error Handling", description: "Test without API key", severity: "high", expected: "Clear error message shown" },
            { id: "T010-02", category: "Error Handling", description: "Test with invalid API key", severity: "high", expected: "Specific error message displayed" },
            { id: "T010-03", category: "Error Handling", description: "Test rate limiting scenario", severity: "medium", expected: "Retry mechanism works" },
            { id: "T010-04", category: "Error Handling", description: "Test empty quiz description", severity: "medium", expected: "Validation message shown" },
            { id: "T010-05", category: "Error Handling", description: "Test network disconnection", severity: "medium", expected: "Network error handled" },
            
            // Data Persistence
            { id: "T011-01", category: "Data Persistence", description: "Set API key and refresh page", severity: "high", expected: "API key persists" },
            { id: "T011-02", category: "Data Persistence", description: "Change theme and refresh", severity: "medium", expected: "Theme preference persists" },
            { id: "T011-03", category: "Data Persistence", description: "Test usage meter persistence", severity: "medium", expected: "Usage data persists" },
            
            // Cross-Browser Compatibility
            { id: "T012-01", category: "Browser Compatibility", description: "Test in Chrome browser", severity: "high", expected: "Full functionality works" },
            { id: "T012-02", category: "Browser Compatibility", description: "Test in Firefox browser", severity: "high", expected: "Full functionality works" },
            { id: "T012-03", category: "Browser Compatibility", description: "Test in Safari browser", severity: "medium", expected: "Full functionality works" },
            { id: "T012-04", category: "Browser Compatibility", description: "Test in Edge browser", severity: "medium", expected: "Full functionality works" },
            { id: "T012-05", category: "Browser Compatibility", description: "Check for console errors across browsers", severity: "medium", expected: "No console errors" },
            
            // Mobile Responsiveness
            { id: "T013-01", category: "Mobile", description: "Test on mobile phone portrait", severity: "high", expected: "Responsive layout works" },
            { id: "T013-02", category: "Mobile", description: "Test on mobile phone landscape", severity: "medium", expected: "Responsive layout works" },
            { id: "T013-03", category: "Mobile", description: "Test on tablet portrait", severity: "medium", expected: "Responsive layout works" },
            { id: "T013-04", category: "Mobile", description: "Test touch interactions", severity: "high", expected: "Touch controls work" },
            { id: "T013-05", category: "Mobile", description: "Test sidebar navigation on mobile", severity: "high", expected: "Mobile navigation works" },
            { id: "T013-06", category: "Mobile", description: "Test quiz taking on mobile", severity: "high", expected: "Mobile quiz interface works" },
            
            // Performance Testing
            { id: "T014-01", category: "Performance", description: "Measure page load times", severity: "medium", expected: "Load times under 3 seconds" },
            { id: "T014-02", category: "Performance", description: "Test multiple quiz generations", severity: "medium", expected: "Consistent performance" },
            { id: "T014-03", category: "Performance", description: "Check memory usage during use", severity: "low", expected: "No memory leaks" },
            { id: "T014-04", category: "Performance", description: "Verify smooth animations", severity: "low", expected: "Smooth transitions" },
            
            // Security & Privacy
            { id: "T015-01", category: "Security", description: "Verify API key local storage only", severity: "critical", expected: "No external data transmission" },
            { id: "T015-02", category: "Security", description: "Check API key masking in UI", severity: "high", expected: "API key hidden by default" },
            { id: "T015-03", category: "Security", description: "Verify HTTPS for API calls", severity: "high", expected: "All calls use HTTPS" },
            { id: "T015-04", category: "Security", description: "Check browser console for credentials", severity: "medium", expected: "No exposed credentials" }
        ];

        let chart;

        // Initialize the application
        function initializeApp() {
            populateTestTable();
            initializeChart();
            updateStats();
            loadSavedData();
        }

        // Populate test table
        function populateTestTable() {
            const tbody = document.getElementById('testTableBody');
            tbody.innerHTML = '';

            testCases.forEach((test, index) => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td class="test-id">${test.id}</td>
                    <td>${test.category}</td>
                    <td>${test.description}</td>
                    <td><span class="severity ${test.severity}">${test.severity.toUpperCase()}</span></td>
                    <td>${test.expected}</td>
                    <td>
                        <select class="status-select" onchange="updateTestStatus(${index}, this.value)">
                            <option value="">-</option>
                            <option value="pass">Pass</option>
                            <option value="fail">Fail</option>
                        </select>
                    </td>
                    <td><input type="text" placeholder="Notes..." style="width: 100%; border: 1px solid #d1d5db; padding: 4px; border-radius: 3px;" onchange="updateTestNotes(${index}, this.value)"></td>
                `;
                tbody.appendChild(row);
            });
        }

        // Update test status
        function updateTestStatus(index, status) {
            const row = document.querySelector(`#testTableBody tr:nth-child(${index + 1})`);
            row.className = status; // Add 'pass' or 'fail' class
            
            // Save to localStorage
            const savedData = JSON.parse(localStorage.getItem('testResults') || '{}');
            savedData[testCases[index].id] = { status, notes: savedData[testCases[index].id]?.notes || '' };
            localStorage.setItem('testResults', JSON.stringify(savedData));
            
            updateStats();
            updateChart();
        }

        // Update test notes
        function updateTestNotes(index, notes) {
            const savedData = JSON.parse(localStorage.getItem('testResults') || '{}');
            if (!savedData[testCases[index].id]) {
                savedData[testCases[index].id] = { status: '', notes: '' };
            }
            savedData[testCases[index].id].notes = notes;
            localStorage.setItem('testResults', JSON.stringify(savedData));
        }

        // Load saved data
        function loadSavedData() {
            const savedData = JSON.parse(localStorage.getItem('testResults') || '{}');
            
            testCases.forEach((test, index) => {
                if (savedData[test.id]) {
                    const row = document.querySelector(`#testTableBody tr:nth-child(${index + 1})`);
                    const select = row.querySelector('.status-select');
                    const notesInput = row.querySelector('input[type="text"]');
                    
                    select.value = savedData[test.id].status;
                    notesInput.value = savedData[test.id].notes;
                    
                    if (savedData[test.id].status) {
                        row.className = savedData[test.id].status;
                    }
                }
            });
            
            updateStats();
            updateChart();
        }

        // Update statistics
        function updateStats() {
            const savedData = JSON.parse(localStorage.getItem('testResults') || '{}');
            
            let passed = 0;
            let failed = 0;
            let total = testCases.length;
            
            Object.values(savedData).forEach(result => {
                if (result.status === 'pass') passed++;
                if (result.status === 'fail') failed++;
            });
            
            const tested = passed + failed;
            const passRate = tested > 0 ? Math.round((passed / tested) * 100) : 0;
            const overallProgress = Math.round((tested / total) * 100);
            
            document.getElementById('totalTests').textContent = total;
            document.getElementById('passedTests').textContent = passed;
            document.getElementById('failedTests').textContent = failed;
            document.getElementById('passRate').textContent = passRate + '%';
            
            // Update progress bar
            document.getElementById('progressFill').style.width = overallProgress + '%';
            document.getElementById('progressText').textContent = overallProgress + '% Complete';
        }

        // Initialize chart
        function initializeChart() {
            const ctx = document.getElementById('chart').getContext('2d');
            chart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Passed', 'Failed', 'Not Tested'],
                    datasets: [{
                        data: [0, 0, testCases.length],
                        backgroundColor: ['#10b981', '#ef4444', '#e5e7eb'],
                        borderWidth: 2,
                        borderColor: '#ffffff'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        }

        // Update chart
        function updateChart() {
            const savedData = JSON.parse(localStorage.getItem('testResults') || '{}');
            
            let passed = 0;
            let failed = 0;
            
            Object.values(savedData).forEach(result => {
                if (result.status === 'pass') passed++;
                if (result.status === 'fail') failed++;
            });
            
            const notTested = testCases.length - passed - failed;
            
            chart.data.datasets[0].data = [passed, failed, notTested];
            chart.update();
        }

        // Reset all tests
        function resetAllTests() {
            if (confirm('Are you sure you want to reset all test results?')) {
                localStorage.removeItem('testResults');
                location.reload();
            }
        }

        // Download Excel file
        function downloadExcel() {
            const savedData = JSON.parse(localStorage.getItem('testResults') || '{}');
            
            const excelData = testCases.map(test => ({
                'Test ID': test.id,
                'Category': test.category,
                'Description': test.description,
                'Severity': test.severity.toUpperCase(),
                'Expected Result': test.expected,
                'Status': savedData[test.id]?.status || '',
                'Notes': savedData[test.id]?.notes || ''
            }));
            
            const worksheet = XLSX.utils.json_to_sheet(excelData);
            const workbook = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(workbook, worksheet, 'Test Cases');
            
            // Add summary sheet
            const summary = [
                ['Test Summary', ''],
                ['Total Tests', testCases.length],
                ['Passed', Object.values(savedData).filter(r => r.status === 'pass').length],
                ['Failed', Object.values(savedData).filter(r => r.status === 'fail').length],
                ['Pass Rate', Math.round((Object.values(savedData).filter(r => r.status === 'pass').length / Math.max(1, Object.values(savedData).filter(r => r.status).length)) * 100) + '%']
            ];
            
            const summarySheet = XLSX.utils.aoa_to_sheet(summary);
            XLSX.utils.book_append_sheet(workbook, summarySheet, 'Summary');
            
            XLSX.writeFile(workbook, 'QuizCraft_AI_Test_Results.xlsx');
        }

        // Export results
        function exportResults() {
            const savedData = JSON.parse(localStorage.getItem('testResults') || '{}');
            const results = {
                timestamp: new Date().toISOString(),
                summary: {
                    total: testCases.length,
                    passed: Object.values(savedData).filter(r => r.status === 'pass').length,
                    failed: Object.values(savedData).filter(r => r.status === 'fail').length
                },
                testCases: testCases.map(test => ({
                    ...test,
                    result: savedData[test.id] || { status: '', notes: '' }
                }))
            };
            
            const blob = new Blob([JSON.stringify(results, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'QuizCraft_AI_Test_Results.json';
            a.click();
            URL.revokeObjectURL(url);
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', initializeApp);
    </script>
</body>
</html>